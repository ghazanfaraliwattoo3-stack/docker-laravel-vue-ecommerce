import{_ as h,e as n,o as d,b as t,a as f,w as b,g as _,r as y,h as r,C as a,D as g,F as v,f as k,t as l,E as x,d as c}from"./app-ByZBqOJD.js";const z={name:"Checkout",data(){return{loading:!1,paymentMethod:"cod",shipping:0,form:{name:"",email:"",address:"",city:"",state:"",zip:"",mobile:""},customerToken:this.$store.getters["customer/token"],user_id:this.$store.getters["customer/id"],discount:0,user_name:this.$store.getters["customer/name"],token:this.$store.getters["user/token"]}},methods:{async fetchShipping(){var s;this.loading=!0;try{const e=await c.get("/api/shipping",{headers:{Authorization:`Bearer ${this.token}`}});this.shipping=((s=e.data.data)==null?void 0:s.shipping)||0,this.$store.dispatch("shipping/updateAddress",this.shipping)}catch(e){console.error("Error fetching shipping:",e)}finally{this.loading=!1}},productSize(s){return s.sizes.find(u=>u.id===s.size).name},onSubmit(){if(!this.form.name){alert("Name is required");return}if(this.form.email){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.form.email)){alert("Please enter a valid email address");return}}else{alert("Email is required");return}if(!this.form.address){alert("Address is required");return}if(!this.form.city){alert("City is required");return}if(!this.form.state){alert("State is required");return}if(!this.form.zip){alert("Zip code is required");return}if(!this.form.mobile){alert("Mobile number is required");return}this.loading=!0,this.submitOrderDetail(),this.loading=!1},async getCustomerDetail(){this.loading=!0;try{const s=await c.get("/api/customer-detail",{headers:{Authorization:`Bearer ${this.customerToken}`,"Content-Type":"application/json"}});if(s.status===200&&s.data.data){const e=s.data.data;this.form.name=s.data.data.name,this.form.email=s.data.data.email,this.form.address=s.data.data.address,this.form.city=s.data.data.city,this.form.state=s.data.data.state,this.form.zip=s.data.data.zip,this.form.mobile=s.data.data.mobile}}catch(s){console.log(s)}finally{this.loading=!1}},async submitOrderDetail(){try{if(this.paymentMethod=="cod"){const s=await c.post("/api/save-order",{user_id:this.user_id,subtotal:parseFloat(this.$store.getters["cart/subtotal"]).toFixed(2),grand_total:(parseFloat(this.$store.getters["cart/subtotal"])+parseFloat(this.shipping)).toFixed(2),shipping:this.shipping,discount:this.discount,payment_status:"not paid",status:"pending",name:this.user_name,email:this.form.email,mobile:this.form.mobile,address:this.form.address,city:this.form.city,state:this.form.state,zip:this.form.zip,cart:this.$store.state.cart.cart},{headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"}});if(s.status===200&&s.data){const e=s.data.order_id;this.$router.push(`/order-confirmation/${e}`),this.$store.dispatch("cart/empty_cart")}}else alert("ruku zara sabr kro")}catch(s){console.log(s)}}},mounted(){this.getCustomerDetail(),this.fetchShipping()}},w={class:"container"},C={class:"row"},F={"aria-label":"breadcrumb "},S={class:"breadcrumb py-3"},V={class:"breadcrumb-item"},D={class:"row mb-5"},q={class:"col-md-7 col-12"},M={class:"row"},U={class:"col-12 mb-3 d-flex"},j={class:"col-6 me-1"},B={class:"col-6"},T={class:"col-12 mb-3"},A={class:"col-12 mb-3 d-flex"},N={class:"col-6 me-1"},$={class:"col-6"},E={class:"col-12 mb-3 d-flex"},P={class:"col-6 me-1"},R={class:"col-6"},O={class:"col-md-5 col-12 text-black"},Z={class:"row"},G={class:"table"},H={key:0},I={class:"col-1"},L=["src"],J={class:"btn btn-size ms-5"},K={class:"row justify-content-end mb-3"},Q={class:"col-3 text-black"},W={class:"d-flex justify-content-between border-bottom pb-1 mt-3"},X={class:"d-flex justify-content-between border-bottom pb-1 mt-3"},Y={class:"d-flex justify-content-between border-bottom pb-1 mt-3"},tt={class:"d-flex"},et={class:"form-check ms-1"},st={class:"d-flex justify-content-end my-3"},ot=["disabled"];function it(s,e,u,rt,i,m){const p=y("router-link");return d(),n("div",w,[t("div",C,[t("nav",F,[t("ol",S,[t("li",V,[f(p,{to:"/"},{default:b(()=>e[9]||(e[9]=[_("Home")])),_:1})]),e[10]||(e[10]=t("li",{class:"breadcrumb-item active","aria-current":"page"}," Checkout ",-1))])])]),t("div",D,[t("div",q,[e[11]||(e[11]=t("h3",{class:"mb-4 text-black"},"Billing Details",-1)),t("div",M,[t("div",U,[t("div",j,[r(t("input",{type:"text",class:"form-control",placeholder:"name",name:"Name","onUpdate:modelValue":e[0]||(e[0]=o=>i.form.name=o)},null,512),[[a,i.form.name]])]),t("div",B,[r(t("input",{type:"email",class:"form-control",placeholder:"Email",name:"email","onUpdate:modelValue":e[1]||(e[1]=o=>i.form.email=o)},null,512),[[a,i.form.email]])])]),t("div",T,[r(t("textarea",{rows:"3",class:"form-control",placeholder:"Address",name:"address","onUpdate:modelValue":e[2]||(e[2]=o=>i.form.address=o)},null,512),[[a,i.form.address]])]),t("div",A,[t("div",N,[r(t("input",{type:"text",class:"form-control",placeholder:"City",name:"city","onUpdate:modelValue":e[3]||(e[3]=o=>i.form.city=o)},null,512),[[a,i.form.city]])]),t("div",$,[r(t("input",{type:"email",class:"form-control",placeholder:"State",name:"state","onUpdate:modelValue":e[4]||(e[4]=o=>i.form.state=o)},null,512),[[a,i.form.state]])])]),t("div",E,[t("div",P,[r(t("input",{type:"text",class:"form-control",placeholder:"Zip",name:"zip","onUpdate:modelValue":e[5]||(e[5]=o=>i.form.zip=o)},null,512),[[a,i.form.zip]])]),t("div",R,[r(t("input",{type:"email",class:"form-control",placeholder:"Mobile",name:"mobile","onUpdate:modelValue":e[6]||(e[6]=o=>i.form.mobile=o)},null,512),[[a,i.form.mobile]])])])])]),t("div",O,[e[12]||(e[12]=t("h3",{class:"mb-4 text-black"},"Items",-1)),t("div",Z,[t("table",G,[s.$store.state.cart.cart.length>0?(d(),n("tbody",H,[(d(!0),n(v,null,k(s.$store.state.cart.cart,o=>(d(),n("tr",{key:o.id},[t("th",I,[t("img",{src:`/uploads/products/small/${o.image}`,width:"70"},null,8,L)]),t("td",null,[t("h5",null,l(o.title),1),t("div",null,[t("span",null,"$"+l((parseFloat(o.price)*parseFloat(o.qty)).toFixed(2)),1),t("button",J,l(m.productSize(o)),1)])])]))),128))])):g("",!0)])])])]),t("div",K,[t("div",Q,[t("div",W,[e[13]||(e[13]=t("span",null,"Subtotal",-1)),t("span",null,"$"+l(s.$store.getters["cart/subtotal"]),1)]),t("div",X,[e[14]||(e[14]=t("span",null,"Shipping",-1)),t("span",null,"$"+l(i.shipping),1)]),t("div",Y,[e[15]||(e[15]=t("strong",null,"Grand Total",-1)),t("span",null,"$"+l((parseFloat(s.$store.getters["cart/subtotal"])+parseFloat(i.shipping)).toFixed(2)),1)]),e[17]||(e[17]=t("h3",{class:"my-3"},"Payment method",-1)),t("div",tt,[t("div",et,[r(t("input",{class:"form-check-input",type:"radio",name:"flexRadioDefault",id:"flexRadioDefault2",value:"cod","onUpdate:modelValue":e[7]||(e[7]=o=>i.paymentMethod=o)},null,512),[[x,i.paymentMethod]]),e[16]||(e[16]=t("label",{class:"form-check-label",for:"flexRadioDefault2"}," Cod ",-1))])]),t("div",st,[t("button",{class:"btn btn-primary",onClick:e[8]||(e[8]=(...o)=>m.onSubmit&&m.onSubmit(...o)),disabled:i.loading}," Pay now ",8,ot)])])])])}const lt=h(z,[["render",it]]);export{lt as default};

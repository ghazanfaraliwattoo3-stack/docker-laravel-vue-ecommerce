import{_,e as l,o as a,b as s,a as x,w as z,g as C,t as p,r as B,D as m,F as f,f as g,h as n,C as d,H as b,v as V,G as E,d as c,l as k}from"./app-hbwqlvku.js";import{E as U,F,a as N}from"./index.esm-CNk301a5.js";const q={name:"product Edit",components:{Form:N,Field:F,ErrorMessage:U},data(){return{isActive:1,loading:!1,errors:null,title:"",category:"",brand:"",short_description:"",description:"",price:"",comapre_price:"",sku:"",barcode:"",qty:"",status:"",image:null,image_id:"",imageName:"",showCategory:[],showBrand:[],is_featured:"",old_image:"",token:this.$store.getters["user/token"],sizes:[],selectSizes:[]}},methods:{async fetchSizes(){const i=this.$store.getters["user/token"];this.loading=!0;try{const e=await c.get("/api/sizes",{headers:{Authorization:`Bearer ${i}`}});e.status===200&&(this.loading=!1,this.sizes=e.data.data)}catch(e){console.log("Error fetching brands",e)}},async handleFileChange(i){this.loading=!0;const e=this.$store.getters["user/token"],r=new FormData,u=i.target.files[0];this.image=u,r.append("image",this.image);try{const t=await c.post("/api/images",r,{headers:{Authorization:`Bearer ${e}`}});t.status===200&&(this.image_id=t.data.data.id,this.imageName=t.data.data.name)}catch(t){k.error("Oops, Failed to create images"),console.log(t)}finally{this.loading=!1}},async fetchCategory(){this.loading=!0;const i=this.$store.getters["user/token"];try{const e=await c.get("/api/categories",{headers:{Authorization:`Bearer ${i}`}});e.status===200&&(this.loading=!1,this.showCategory=e.data.data)}catch(e){console.log("Error fetching categories",e)}},async fetchbrand(){const i=this.$store.getters["user/token"];this.loading=!0;try{const e=await c.get("/api/brands",{headers:{Authorization:`Bearer ${i}`}});e.status===200&&(this.loading=!1,this.showBrand=e.data.data)}catch(e){console.log("Error fetching brands",e)}},async onSubmit(i){i.name;const e=this.$store.getters["user/token"];try{const r=this.$route.params.id;(await c.put(`/api/products/${r}`,{title:this.title,price:this.price,compare_price:this.compare_price,category_id:this.category,brand_id:this.brand,qty:this.qty,sku:this.sku,barcode:this.barcode,short_description:this.short_description,description:this.description,status:this.status,is_featured:this.is_featured,image:this.image_id,sizes:this.selectSizes},{headers:{Authorization:`Bearer ${e}`}})).status===200&&(k.success("Product has been updated successfully"),this.$router.push({name:"products"}))}catch(r){r.response?r.response.data.errors?this.errors=r.response.data.errors:this.errors=r.response.data.message:(k.error("Oops, Failed to create brand"),console.log(r))}},async fetchproduct(){this.loading=!0;try{const i=this.$route.params.id,e=await c.get(`/api/products/${i}`,{headers:{Authorization:`Bearer ${this.token}`}});if(e.status===200){this.loading=!1;const r=e.data.data;this.title=r.title,this.category=r.category_id,this.brand=r.brand_id,this.short_description=r.short_description,this.description=r.description,this.price=r.price,this.compare_price=r.compare_price,this.sku=r.sku,this.barcode=r.barcode,this.qty=r.qty,this.status=r.status,this.is_featured=r.is_featured,this.old_image=r.image,console.log("size",r),this.selectSizes=r.sizes.map(u=>u.id),console.log(this.selectSizes)}}catch(i){console.log("Error fetching products",i)}}},mounted(){this.fetchproduct(),this.fetchCategory(),this.fetchbrand(),this.fetchSizes()}},D={class:"container"},A={class:"d-flex justify-content-end"},P={key:0,class:"alert alert-danger"},H={class:"row"},I={class:"mb-3 col-12"},M={class:"mb-3 col-md-6 col-12"},O=["value"],T={class:"mb-3 col-md-6 col-12"},G=["value"],j={class:"mb-3"},L={class:"mb-3"},Q={class:"mb-3 col-md-6 col-12"},Y={class:"mb-3 col-md-6 col-12"},J={class:"mb-3 col-md-6 col-12"},K={class:"mb-3 col-md-6 col-12"},R={class:"mb-3 col-md-6 col-12"},W={class:"mb-3 col-md-6 col-12"},X={class:"mb-3 col-12"},Z={class:"d-flex flex-wrap gap-1"},$=["id","value"],ee=["for"],se={class:"mb-3 col-12"},te={key:0,class:"my-3"},oe=["src","alt"],re={key:1,class:"my-3"},ie=["src"],le=["disabled"];function ae(i,e,r,u,t,h){const v=B("router-link");return a(),l("div",D,[s("div",A,[x(v,{to:{name:"products"},class:"btn text-decoration-underline"},{default:z(()=>[C("Go to back"+p(t.image_id),1)]),_:1})]),e[38]||(e[38]=s("h3",{class:"text-center mb-md-5"},"Edit product",-1)),s("form",{class:"col-md-8 mx-auto",onSubmit:e[14]||(e[14]=E((...o)=>h.onSubmit&&h.onSubmit(...o),["prevent"]))},[t.errors?(a(),l("div",P,[(a(!0),l(f,null,g(t.errors,(o,y)=>(a(),l("div",{key:y},[(a(!0),l(f,null,g(o,(w,S)=>(a(),l("span",{key:S},p(w),1))),128))]))),128))])):m("",!0),s("div",H,[s("div",I,[e[15]||(e[15]=s("label",{for:"title",class:"form-label"},"Title",-1)),n(s("input",{type:"text",class:"form-control",id:"title","aria-describedby":"emailHelp",placeholder:"Enter product","onUpdate:modelValue":e[0]||(e[0]=o=>t.title=o)},null,512),[[d,t.title]])]),s("div",M,[e[17]||(e[17]=s("label",{for:"category",class:"form-label"}," Category ",-1)),t.showCategory&&t.showCategory.length>0?n((a(),l("select",{key:0,class:"form-select","aria-label":"Default select example",as:"select",id:"category","onUpdate:modelValue":e[1]||(e[1]=o=>t.category=o)},[e[16]||(e[16]=s("option",{value:"",disabled:""},"Select a Category",-1)),(a(!0),l(f,null,g(t.showCategory,o=>(a(),l("option",{key:o.id,value:o.id},p(o.name),9,O))),128))],512)),[[b,t.category]]):m("",!0)]),s("div",T,[e[19]||(e[19]=s("label",{for:"brand",class:"form-label"}," Brand ",-1)),t.showBrand&&t.showBrand.length>0?n((a(),l("select",{key:0,class:"form-select","aria-label":"Default select example",id:"brand",as:"select","onUpdate:modelValue":e[2]||(e[2]=o=>t.brand=o)},[e[18]||(e[18]=s("option",{value:"",disabled:""},"Select a Brand",-1)),(a(!0),l(f,null,g(t.showBrand,o=>(a(),l("option",{key:o.id,value:o.id},p(o.name),9,G))),128))],512)),[[b,t.brand]]):m("",!0)]),s("div",j,[e[20]||(e[20]=s("label",{for:"short_description",class:"form-label"},"Short Description",-1)),n(s("textarea",{class:"form-control",id:"short_description",rows:"3",placeholder:"Short Description","onUpdate:modelValue":e[3]||(e[3]=o=>t.short_description=o)},null,512),[[d,t.short_description]])]),s("div",L,[e[21]||(e[21]=s("label",{for:"",class:"form-label"},"Description",-1)),n(s("textarea",{class:"form-control",id:"description",rows:"7",placeholder:"description","onUpdate:modelValue":e[4]||(e[4]=o=>t.description=o)},null,512),[[d,t.description]])]),e[34]||(e[34]=s("h3",{class:"my-3"},"Pricing",-1)),s("div",Q,[e[22]||(e[22]=s("label",{for:"price",class:"form-label"}," Price ",-1)),n(s("input",{type:"number",class:"form-control",id:"price","aria-describedby":"emailHelp",placeholder:"Enter price","onUpdate:modelValue":e[5]||(e[5]=o=>t.price=o)},null,512),[[d,t.price]])]),s("div",Y,[e[23]||(e[23]=s("label",{for:"compare_price",class:"form-label"}," Comapre Price ",-1)),n(s("input",{type:"number",class:"form-control",id:"compare_price","aria-describedby":"emailHelp",placeholder:"Enter compare price","onUpdate:modelValue":e[6]||(e[6]=o=>i.compare_price=o)},null,512),[[d,i.compare_price]])]),e[35]||(e[35]=s("h3",{class:"my-3"},"Inventory",-1)),s("div",J,[e[24]||(e[24]=s("label",{for:"sku",class:"form-label"}," Sku ",-1)),n(s("input",{type:"text",class:"form-control",id:"sku","aria-describedby":"emailHelp",placeholder:"Sku","onUpdate:modelValue":e[7]||(e[7]=o=>t.sku=o)},null,512),[[d,t.sku]])]),s("div",K,[e[25]||(e[25]=s("label",{for:"barcode",class:"form-label"}," Barcode ",-1)),n(s("input",{type:"text",class:"form-control",id:"barcode",placeholder:"barcode","onUpdate:modelValue":e[8]||(e[8]=o=>t.barcode=o)},null,512),[[d,t.barcode]])]),s("div",R,[e[26]||(e[26]=s("label",{class:"form-label",for:"qty"}," Qty ",-1)),n(s("input",{type:"number",class:"form-control",id:"qty",placeholder:"qty","onUpdate:modelValue":e[9]||(e[9]=o=>t.qty=o)},null,512),[[d,t.qty]])]),s("div",W,[e[28]||(e[28]=s("label",{for:"status",class:"form-label"}," Status ",-1)),n(s("select",{class:"form-select",id:"status",as:"select","onUpdate:modelValue":e[10]||(e[10]=o=>t.status=o)},e[27]||(e[27]=[s("option",{value:"",disabled:""},"Select a status",-1),s("option",{value:"1",selected:""},"Active",-1),s("option",{value:"0"},"Block",-1)]),512),[[b,t.status]])]),e[36]||(e[36]=s("h3",{class:"my-3"},"Product Image",-1)),s("div",X,[e[30]||(e[30]=s("label",{for:"featured ",class:"form-label"}," Featured ",-1)),n(s("select",{class:"form-select",id:"featured ",as:"select","onUpdate:modelValue":e[11]||(e[11]=o=>t.is_featured=o)},e[29]||(e[29]=[s("option",{value:"",disabled:""},"Select a featured",-1),s("option",{value:"yes",selected:""},"Yes",-1),s("option",{value:"no"},"No",-1)]),512),[[b,t.is_featured]])]),e[37]||(e[37]=s("h3",{class:"my-3"},"Product Sizes",-1)),s("div",Z,[(a(!0),l(f,null,g(t.sizes,o=>(a(),l("div",{class:"form-check form-check-inline",key:o.id},[n(s("input",{class:"form-check-input",type:"checkbox",id:"size-"+o.id,value:o.id,"onUpdate:modelValue":e[12]||(e[12]=y=>t.selectSizes=y)},null,8,$),[[V,t.selectSizes]]),s("label",{class:"form-check-label",for:"size-"+o.id},p(o.name),9,ee)]))),128))]),s("div",se,[e[31]||(e[31]=s("label",{for:"image",class:"form-label"},"Edit Image",-1)),s("input",{type:"file",class:"form-control",id:"image",onChange:e[13]||(e[13]=(...o)=>h.handleFileChange&&h.handleFileChange(...o))},null,32)]),t.imageName?(a(),l("div",te,[e[32]||(e[32]=s("h3",null,"New Image",-1)),s("img",{src:`/uploads/temp/${t.imageName}`,class:"img-fluid rounded-top",alt:t.imageName},null,8,oe)])):m("",!0),t.old_image?(a(),l("div",re,[e[33]||(e[33]=s("h3",null,"Old Image",-1)),s("img",{src:`/uploads/products/large/${t.old_image}`,class:"img-fluid rounded-top",alt:""},null,8,ie)])):m("",!0)]),s("button",{type:"submit",class:"btn btn-dark",disabled:t.loading}," Update product ",8,le)],32)])}const ce=_(q,[["render",ae]]);export{ce as default};
